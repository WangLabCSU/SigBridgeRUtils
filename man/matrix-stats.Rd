% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/11_matrixStats.R, R/14_normalize.quantiles.R
\name{matrix-stats}
\alias{matrix-stats}
\alias{rowVars}
\alias{colVars}
\alias{rowSds}
\alias{colSds}
\alias{colQuantiles}
\alias{normalize.quantiles}
\title{Matrix Statistics Functions (Not Necessarily)}
\usage{
rowVars(x, na.rm = FALSE, ...)

colVars(x, na.rm = FALSE, ...)

rowSds(x, na.rm = FALSE, ...)

colSds(x, na.rm = FALSE, ...)

colQuantiles(x, probs = seq(0, 1, 0.25), ...)

normalize.quantiles(x, copy = TRUE, keep.names = FALSE, ...)
}
\arguments{
\item{x}{A numeric matrix (dense or sparse Matrix format) where columns
represent samples and rows represent features.}

\item{na.rm}{Logical indicating whether to remove missing values.}

\item{...}{Additional arguments (currently not used).}

\item{probs}{Numeric vector of probabilities with values between 0 and 1.}

\item{copy}{Logical indicating whether to work on a copy of the matrix (TRUE)
or modify in-place (FALSE). Note: sparse matrices always create a copy.}

\item{keep.names}{Logical indicating whether to preserve row and column names.}
}
\value{
A numeric vector of length nrow(x) containing row variances.

A numeric vector of length ncol(x) containing column variances.

A numeric vector of length nrow(x) containing row standard deviations.

A numeric vector of length ncol(x) containing column standard deviations.

A matrix of quantiles with length(probs) rows and ncol(x) columns.

A numeric matrix of the same type as input with quantile-normalized data.
If input is a sparse Matrix, output will also be sparse.
}
\description{
A collection of functions for computing matrix statistics with fallback
implementations when specialized packages are not available. These functions
provide efficient row-wise and column-wise computations for large matrices.

rowVars computes the variance for each row of a numeric matrix.
Uses matrixStats::rowVars if available, otherwise provides a base R implementation.

colVars computes the variance for each column of a numeric matrix.
Uses matrixStats::colVars if available, otherwise provides a base R implementation.

rowSds computes the standard deviation for each row of a numeric matrix.
Uses matrixStats::rowSds if available, otherwise computes as the square root of row variances.

colSds computes the standard deviation for each column of a numeric matrix.
Uses matrixStats::colSds if available, otherwise computes as the square root of column variances.

colQuantiles computes quantiles for each column of a numeric matrix.
Uses matrixStats::colQuantiles if available, otherwise uses base R quantile function.

normalize.quantiles performs quantile normalization on a matrix, transforming
the distributions of each column to match a common target distribution.
Supports both dense matrices and sparse Matrix formats (dgCMatrix, dgRMatrix, etc.)
for memory-efficient processing of large datasets.
}
\examples{
mat <- matrix(rnorm(100), nrow = 10, ncol = 10)

# Compute row variances
row_vars <- rowVars(mat)

# With missing values
mat[1, 1] <- NA
row_vars_na <- rowVars(mat, na.rm = TRUE)

mat <- matrix(rnorm(100), nrow = 10, ncol = 10)

# Compute column variances
col_vars <- colVars(mat)

# With missing values
mat[1, 1] <- NA
col_vars_na <- colVars(mat, na.rm = TRUE)

mat <- matrix(rnorm(100), nrow = 10, ncol = 10)
row_sds <- rowSds(mat)

mat <- matrix(rnorm(100), nrow = 10, ncol = 10)
col_sds <- colSds(mat)

mat <- matrix(rnorm(100), nrow = 10, ncol = 10)

# Compute quartiles for each column
quartiles <- colQuantiles(mat)

# Compute specific quantiles
specific_quantiles <- colQuantiles(mat, probs = c(0.1, 0.5, 0.9))

# Dense matrix
mat <- matrix(rnorm(100), nrow = 10, ncol = 10)
normalized_mat <- normalize.quantiles(mat)

# Sparse matrix for memory efficiency
library(Matrix)
sparse_mat <- Matrix(mat, sparse = TRUE)
normalized_sparse <- normalize.quantiles(sparse_mat)

# Large sparse matrix example (single-cell RNA-seq style)
large_sparse <- sparseMatrix(
    i = sample(1:10000, 50000, replace = TRUE),
    j = sample(1:100, 50000, replace = TRUE),
    x = rpois(50000, 2),
    dims = c(10000, 100)
)
normalized_large <- normalize.quantiles(large_sparse, keep.names = TRUE)

# Preserve original names
rownames(mat) <- paste0("Gene", 1:10)
colnames(mat) <- paste0("Sample", 1:10)
normalized_with_names <- normalize.quantiles(mat, keep.names = TRUE)

}
\seealso{
\code{\link[matrixStats:rowVars]{matrixStats::rowVars()}} for the underlying implementation

\code{\link[matrixStats:rowVars]{matrixStats::colVars()}} for the underlying implementation

\code{\link[matrixStats:rowSds]{matrixStats::rowSds()}} for the underlying implementation

\code{\link[matrixStats:rowSds]{matrixStats::colSds()}} for the underlying implementation

\code{\link[matrixStats:rowQuantiles]{matrixStats::colQuantiles()}} for the underlying implementation

\itemize{
\item \code{\link[preprocessCore:normalize.quantiles]{preprocessCore::normalize.quantiles()}} for the reference implementation
\item \code{\link[Matrix:Matrix]{Matrix::Matrix()}} for sparse matrix formats
}
}
